\section{Security Analysis}
WLAN authentication is the foundation of WLAN security. The 802.11i protocol defines how to complete authentication and encrypt data before transmission. It can be run in two modes: pre-shared key based mode(also known as WPA-PSK) and 802.1X authentication server based mode(also known as WPA-EAP). For both modes, the authenticator and the supplicant should share a secret called PMK. For pre-shared key based mode, the PMK is derived from a pre-shared key, while the pre-shared key is derived form a passphrase. The passphrase is a short string usually containing 8-20 characters which is easy to remember and guess such as name, birthday or telephone. Administrators set passphrase for APs and tell it to authorized users. Authorized users type the passphrase into mobile devices. And then the authenticator and the supplicant will share the same PMK. For 802.1X authentication server mode, an 802.1X authentication server, usually a RADIUS server, is needed. The PMK is generated from a TLS negotiation between the authentication server and the supplicant and than the authentication server securely transport it to the authenticator. This mode is considered more secure as the TLS protocol is considered secure while the passphrase is vulnerable. Once the authenticator and the supplicant share the PMK, a 4-way handshake will be proceeded. We have observed that though there are many attacks aimed at the 4-way handshake, and some attacks are extremely critical, we can avoid all known exploits if deployed properly. So the 4-way handshake is still considered secure~\cite{Liu2010Survey} . After the 4-way handshake, the authenticator and the supplicant share a temporary secret key. They will use it to encrypt and decrypt communication data. 


In summary, the WPA-EAP protocol is still considered secure while the WPA-PSK protocol exists some security concerns. The short board of WPA-PSK protocol is the passphrase as the passphrase is easy to guess and remain unchanged for a long time. Once attackers get the passphrase, there is no security for the WPA-PSK protocol. Attackers will also be able to join the WLAN degrading authorized users’ online experience, get authorized users’ private information, or set up a fishing AP cheating authorized users connecting and transporting data to it. A brute force attack is considered realistic to obtain passphrase. Attackers can try all potential passphrases until finding the right one. Nevertheless, it may take much time for attackers to successfully implement an a brute force attack. However, the brute force attack can be accelerated with the help of cloud-computing, GPU, distributed algorithm, and the like. To improve the security of the passphrase-based WPA-PSK protocol, WLAN administrators should set complex passphrase which is hard to guess. They should change passphrases frequently and distribute new passphrases to authorized users. It will obviously increase the burden of both administrators and authorized users and is impractical for large WLAN. Our system automatically achieves the above suggestions putting no extra burden to the WLAN system. 


In the proposed system, we apply an evolving passwords scheme to the WPA-PSK protocol which can improve the security of the WPA-PSK protocol and thus improve the WLAN security. 


First, the password changes from a text string with a length of 8-20 characters to a random number of a length of 32 bytes. The password space becomes extremely large which makes attackers impossible to guess. 


Second, the password evolves all the time. For attackers, the old password and the new password are irrelevant. Even if they know the old password, they cannot calculate out the new password because they cannot get the long pseudo random physical parameter. On the contrary, even if they know the new password, the hash function prevent them getting the old password. So the evolving password scheme is just like administrators regularly changing passwords. Attackers must find the right password before it evolves. Once the password evolves, attackers have to start all over again. Administrators can shorten the update interval to decrease the possibility of a successful attack. Even if an attacker gets a password, he/she can only join WLAN for a little time - before the password evolving, reducing the impact of a successful attack. 


Meanwhile, the proposed evolving password scheme will not introduce extra and unknown vulnerabilities to the WPA-PSK protocol. The password is set and distributed in the same way as before. The password update is achieved separately and offline. There is almost no more information transmitted online to update passwords. The only interaction between the authenticator and the supplicant is distributing the physical parameter. However, the physical parameter is broadcast and acquired in a secure location unreachable for attackers. So attackers cannot intervene the update process and get more information than static password scheme. 


Besides, attackers cannot deceive authorized users to accept a wrong new password. When a mobile device parses out a physical parameter from a beacon frame, it cannot verify its correction. So it only calculates a temporary password but not update its own password immediately. It will try to use the temporary password to pass the authentication of APs. Only it successfully connect to APs will it accept the temporary password as the correct new password and then update the current password and store the new password into the configuration file. However, a fake master AP that knows the old password can broadcast a wrong physical parameter. An unsuspecting mobile device may update a wrong password. It cannot realize it until it try to connect to a valid AP, and it will never access WLAN again until it resets the password. 
